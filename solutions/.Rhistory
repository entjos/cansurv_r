#' 0 [Alive]
#' 4 [Lost to follow-up]
#' agegrp is coded as follows
#' 1 [0-44]
#' 2 [45-59]
#' 3 [60-74]
#' 4 [75+]
#' sex is coded as follows
#' 1 [Male]
#' 2 [Female]
#'
#' subsite is coded as follows
#' 1  [Head and Neck]
#' 2  [Trunk]
#' 3  [Limbs]
#' 4  [Multiple and NOS]
#'
#' stage is coded as follows
#' 0  [Unknown]
#' 1  [Localised]
#' 2  [Regional]
#' 3  [Distant]
# Restrict follow-up to 10 years and create new variable for all-cause death and cause-specific death
melanoma_10y <- mutate(melanoma,
status  = ifelse((status == 1 | status == 2) & surv_mm<= 120, 1, 0), # Redefine status
surv_mm = ifelse(surv_mm<= 120, surv_mm, 120),     # censored everyone after 120 months
t = surv_mm/12                                     # surv_mm in years
)
##(a)-i. Split the data with narrow (1 month) time intervals
# Split the time scale
melanoma_10y_spl <- survSplit(melanoma_10y, cut=1/12*(0:120), end="t", start="start", event = "status" ) # event must be a character variable
## Calculate follow-up time and recode start time as a factor
melanoma_10y_spl <- mutate(melanoma_10y_spl,
pt = t - start,
fu = as.factor(start) )
## Collapse
melanoma_10y_spl2 <- melanoma_10y_spl %>%
group_by_all(fu, female, year8594, agegrp) %>%
summarise(pt=sum(pt), d = sum(status == 1))
melanoma_10y_spl2 <- melanoma_10y_spl %>%
group_by(fu, female, year8594, agegrp) %>%
summarise(pt=sum(pt), d = sum(status == 1))
melanoma_10y_spl2 <- melanoma_10y_spl %>%
group_by_all(fu, female, year8594, agegrp) %>%
summarise(pt=sum(pt), d = sum(status == 1))
## Generate interval
melanoma_10y_spl2 <- melanoma_10y_spl2  %>%
group_by(fu) %>%
mutate(interval =group_indices()) ## equivalent to Stata's egen interval=group()
?predict.glm
melanoma_10y_spl2$haz_grp <- predict(poisson_a, newdata = melanoma_10y_spl2, type = "link")
View(melanoma_10y_spl2)
melanoma_10y_spl2$haz_grp <- exp(predict(poisson_a, type = "response"))
melanoma_10y_spl2$haz_grp <- exp(predict(poisson_a, newdata = melanoma_10y_spl2, type = "response"))
View(melanoma_10y_spl2)
intervals <- levels(melanoma_10y_spl2$interval)
melanoma_10y_spl2$haz_grp <- exp(predict(poisson_a, newdata= data.frame(interval=intervals),
type = "response"))
melanoma_10y_spl2$haz_grp <- exp(predict(poisson_a, newdata= data.frame(melanoma_10y_spl2$interval=intervals),
type = "response"))
haz_grp <- exp(predict(poisson_a, newdata= data.frame(interval=intervals),
type = "response"))
melanoma_10y_spl2 <- melanoma_10y_spl2  %>%
group_by(fu) %>%
mutate(interval =as.factor(group_indices())) ## equivalent to Stata's egen interval=group()
##(a)-ii.Fit a model with a parameter for each interval
## glm -1 is suppress constant term, equivalent to Stata's nocons
poisson_a <- glm( d ~ interval -1 + offset( log(pt)),
family = poisson,
data = melanoma_10y_spl2 )
summary(poisson_a)
eform(poisson_a)
intervals <- levels(melanoma_10y_spl2$interval)
haz_grp <- exp(predict(poisson_a, newdata= data.frame(interval=intervals),
type = "response"))
View(melanoma_10y_spl2)
intervals <- as.factor(levels(melanoma_10y_spl2$interval))
haz_grp <- exp(predict(poisson_a, newdata= data.frame(interval=intervals),
type = "response"))
intervals <-levels(melanoma_10y_spl2$interval)
haz_grp <- exp(predict(poisson_a, newdata= data.frame(interval=intervals),
type = "response"))
haz_grp <- exp(predict(poisson_a, newdata= data.frame(interval=intervals),
type = "link"))
haz_grp <- exp(predict(poisson_a,type = "link"))
intervals <- data.frame(interval = unique(melanoma_10y_spl2$interval), offset = 0)
haz_grp <- exp(predict(poisson_a, newdata = intervals, type = "link"))
intervals <- data.frame(interval = unique(melanoma_10y_spl2$interval), offset = 0)
haz_grp <- exp(predict(poisson_a, newdata = intervals, type = "link"))
melanoma_10y_spl2 <- melanoma_10y_spl2  %>%
group_by(fu) %>%
mutate(interval =group_indices()) ## equivalent to Stata's egen interval=group()
##(a)-ii.Fit a model with a parameter for each interval
## glm -1 is suppress constant term, equivalent to Stata's nocons
poisson_a <- glm( d ~ as.factor(interval) -1 + offset( log(pt)),
family = poisson,
data = melanoma_10y_spl2 )
summary(poisson_a)
eform(poisson_a)
##  predict the baseline (one parameter for each interval)
intervals <- data.frame(interval = unique(melanoma_10y_spl2$interval), offset = 0)
haz_grp <- exp(predict(poisson_a, newdata = intervals, type = "link"))
melanoma_10y_spl2 <- melanoma_10y_spl2  %>%
group_by(fu) %>%
mutate(interval =group_indices()) ## equivalent to Stata's egen interval=group()
##(a)-ii.Fit a model with a parameter for each interval
## glm -1 is suppress constant term, equivalent to Stata's nocons
poisson_a <- glm( d ~ as.factor(interval) -1 + offset( log(pt)),
family = poisson,
data = melanoma_10y_spl2 )
summary(poisson_a)
eform(poisson_a)
##  predict the baseline (one parameter for each interval)
intervals <- data.frame(interval = unique(melanoma_10y_spl2$interval), offset = 0)
haz_grp <- exp(predict(poisson_a, newdata = intervals, type = "link"))
exp(predict(poisson_a, newdata = intervals, type = "link"))
View(intervals)
intervals <- data.frame(interval = "unique(melanoma_10y_spl2$interval)")
View(intervals)
intervals <- data.frame(interval = "unique(melanoma_10y_spl2$interval)", offset = 0)
View(intervals)
intervals <- data.frame(interval = unique(melanoma_10y_spl2$interval), offset = 0)
intervals <- data.frame(interval = melanoma_10y_spl2$interval, offset = 0)
intervals <- data.frame(interval = as.factor(unique(melanoma_10y_spl2$interval)), offset = 0)
haz_grp <- exp(predict(poisson_a, newdata = intervals, type = "link"))
View(intervals)
predict(poisson_a, newdata = intervals, type = "link")
intervals <- data.frame(interval = as.factor(unique(melanoma_10y_spl2$interval)))
predict(poisson_a, newdata = intervals, type = "link")
predict(poisson_a, newdata = intervals, type = "response")
intervals <- data.frame(interval = as.factor(unique(melanoma_10y_spl2$interval)), log(pt) = 0)
##  predict the baseline (one parameter for each interval)
intervals <- data.frame(interval = as.factor(unique(melanoma_10y_spl2$interval)))
predict(poisson_a, newdata = intervals, type = "response")
newdata <- expand.grid(interval = 1:120)
View(newdata)
predict(poisson_a, newdata = interval, type = "response")
predict(poisson_a, newdata = newdata, type = "response")
newdata <- expand.grid(interval = as.factor(1:120))
View(newdata)
predict(poisson_a, newdata = newdata, type = "response")
newdata <- expand.grid(interval = as.factor(1:120), pt = 1 )
View(newdata)
predict(poisson_a, newdata = newdata, type = "response")
melanoma_10y_spl2$haz_grp <- predict(poisson_a, newdata = newdata, type = "response")
haz_grp <- predict(poisson_a, newdata = newdata, type = "response")
###############################################################################
## Load the packages
library(biostat3)
library(haven)
library(dplyr)   # manipulate data
library(splines) # natural splines
## Read data
## All stages
melanoma <- read_dta("melanoma.dta")%>%
mutate(year8594 = ifelse(year8594 == 1, "Diagnosed 85-94", "Diagnosed 75-84"),
agegrp = as.factor(agegrp),
sex = as.factor(sex),
female = ifelse(sex == 2, 1, 0),
stage = as.factor(stage),
subsite = as.factor(subsite))
#' status is coded as follows
#' 1 [Dead: cancer]
#' 2 [Dead: other]
#' 0 [Alive]
#' 4 [Lost to follow-up]
#' agegrp is coded as follows
#' 1 [0-44]
#' 2 [45-59]
#' 3 [60-74]
#' 4 [75+]
#' sex is coded as follows
#' 1 [Male]
#' 2 [Female]
#'
#' subsite is coded as follows
#' 1  [Head and Neck]
#' 2  [Trunk]
#' 3  [Limbs]
#' 4  [Multiple and NOS]
#'
#' stage is coded as follows
#' 0  [Unknown]
#' 1  [Localised]
#' 2  [Regional]
#' 3  [Distant]
# Restrict follow-up to 10 years and create new variable for all-cause death and cause-specific death
melanoma_10y <- mutate(melanoma,
status  = ifelse((status == 1 | status == 2) & surv_mm<= 120, 1, 0), # Redefine status
surv_mm = ifelse(surv_mm<= 120, surv_mm, 120),     # censored everyone after 120 months
t = surv_mm/12                                     # surv_mm in years
)
##(a)-i. Split the data with narrow (1 month) time intervals
# Split the time scale
melanoma_10y_spl <- survSplit(melanoma_10y, cut=1/12*(0:120), end="t", start="start", event = "status" ) # event must be a character variable
## Calculate follow-up time and recode start time as a factor
melanoma_10y_spl <- mutate(melanoma_10y_spl,
pt = t - start,
fu = as.factor(start) )
## Collapse
melanoma_10y_spl2 <- melanoma_10y_spl %>%
group_by_all(fu, female, year8594, agegrp) %>%
summarise(pt=sum(pt), d = sum(status == 1))
## Generate interval
melanoma_10y_spl2 <- melanoma_10y_spl2  %>%
group_by(fu) %>%
mutate(interval =group_indices()) ## equivalent to Stata's egen interval=group()
##(a)-ii.Fit a model with a parameter for each interval
## glm -1 is suppress constant term, equivalent to Stata's nocons
poisson_a <- glm( d ~ as.factor(interval) -1 + offset( log(pt)),
family = poisson,
data = melanoma_10y_spl2 )
summary(poisson_a)
eform(poisson_a)
melanoma <- read_dta("melanoma.dta")%>%
mutate(year8594 = ifelse(year8594 == 1, "Diagnosed 85-94", "Diagnosed 75-84"),
agegrp = as.factor(agegrp),
sex = as.factor(sex),
female = ifelse(sex == 2, 1, 0),
stage = as.factor(stage),
subsite = as.factor(subsite))
View(melanoma)
library(biostat3)
library(haven)
library(dplyr)   # manipulate data
library(splines) # natural splines
## Read data
## All stages
melanoma <- read_dta("melanoma.dta")%>%
mutate(year8594 = ifelse(year8594 == 1, "Diagnosed 85-94", "Diagnosed 75-84"),
agegrp = as.factor(agegrp),
sex = as.factor(sex),
female = ifelse(sex == "2", "1", 0),
stage = as.factor(stage),
subsite = as.factor(subsite))
#' status is coded as follows
#' 1 [Dead: cancer]
#' 2 [Dead: other]
#' 0 [Alive]
#' 4 [Lost to follow-up]
#' agegrp is coded as follows
#' 1 [0-44]
#' 2 [45-59]
#' 3 [60-74]
#' 4 [75+]
#' sex is coded as follows
#' 1 [Male]
#' 2 [Female]
#'
#' subsite is coded as follows
#' 1  [Head and Neck]
#' 2  [Trunk]
#' 3  [Limbs]
#' 4  [Multiple and NOS]
#'
#' stage is coded as follows
#' 0  [Unknown]
#' 1  [Localised]
#' 2  [Regional]
#' 3  [Distant]
# Restrict follow-up to 10 years and create new variable for all-cause death and cause-specific death
melanoma_10y <- mutate(melanoma,
status  = ifelse((status == 1 | status == 2) & surv_mm<= 120, 1, 0), # Redefine status
surv_mm = ifelse(surv_mm<= 120, surv_mm, 120),     # censored everyone after 120 months
t = surv_mm/12                                     # surv_mm in years
)
##(a)-i. Split the data with narrow (1 month) time intervals
# Split the time scale
melanoma_10y_spl <- survSplit(melanoma_10y, cut=1/12*(0:120), end="t", start="start", event = "status" ) # event must be a character variable
## Calculate follow-up time and recode start time as a factor
melanoma_10y_spl <- mutate(melanoma_10y_spl,
pt = t - start,
fu = as.factor(start) )
## Collapse
melanoma_10y_spl2 <- melanoma_10y_spl %>%
group_by_all(fu, female, year8594, agegrp) %>%
summarise(pt=sum(pt), d = sum(status == 1))
View(melanoma)
source('~/cansurv_r/solutions/q130.R', echo=TRUE)
View(melanoma_10y_spl)
View(melanoma_10y)
View(melanoma_10y_spl)
melanoma_10y_spl2 <- melanoma_10y_spl %>%
group_by_all(fu, female, year8594, agegrp) %>%
summarise(pt=sum(pt), d = sum(status == 1))
## Exercise 130
## Created: 2021-04-16 Enoch Chen
## Edited:  2021-04-16 Enoch Chen
###############################################################################
## Load the packages
library(biostat3)
library(haven)
library(dplyr)   # manipulate data
library(splines) # natural splines
## Read data
## All stages
melanoma <- read_dta("melanoma.dta")%>%
mutate(year8594 = ifelse(year8594 == 1, "Diagnosed 85-94", "Diagnosed 75-84"),
agegrp = as.factor(agegrp),
female = ifelse(sex == 2, 1, 0),
stage = as.factor(stage),
subsite = as.factor(subsite))
#' status is coded as follows
#' 1 [Dead: cancer]
#' 2 [Dead: other]
#' 0 [Alive]
#' 4 [Lost to follow-up]
#' agegrp is coded as follows
#' 1 [0-44]
#' 2 [45-59]
#' 3 [60-74]
#' 4 [75+]
#' sex is coded as follows
#' 1 [Male]
#' 2 [Female]
#'
#' subsite is coded as follows
#' 1  [Head and Neck]
#' 2  [Trunk]
#' 3  [Limbs]
#' 4  [Multiple and NOS]
#'
#' stage is coded as follows
#' 0  [Unknown]
#' 1  [Localised]
#' 2  [Regional]
#' 3  [Distant]
# Restrict follow-up to 10 years and create new variable for all-cause death and cause-specific death
melanoma_10y <- mutate(melanoma,
status  = ifelse((status == 1 | status == 2) & surv_mm<= 120, 1, 0), # Redefine status
surv_mm = ifelse(surv_mm<= 120, surv_mm, 120),     # censored everyone after 120 months
t = surv_mm/12                                     # surv_mm in years
)
##(a)-i. Split the data with narrow (1 month) time intervals
# Split the time scale
melanoma_10y_spl <- survSplit(melanoma_10y, cut=1/12*(0:120), end="t", start="start", event = "status" ) # event must be a character variable
## Calculate follow-up time and recode start time as a factor
melanoma_10y_spl <- mutate(melanoma_10y_spl,
pt = t - start,
fu = as.factor(start) )
## Collapse
melanoma_10y_spl2 <- melanoma_10y_spl %>%
group_by_all(fu, female, year8594, agegrp) %>%
summarise(pt=sum(pt), d = sum(status == 1))
melanoma_10y_spl2 <- melanoma_10y_spl %>%
group_by(fu, female, year8594, agegrp) %>%
summarise(pt=sum(pt), d = sum(status == 1))
View(melanoma_10y_spl2)
melanoma_10y_spl2 <- melanoma_10y_spl2  %>%
group_by(fu) %>%
mutate(interval =group_indices()) ## equivalent to Stata's egen interval=group()
View(melanoma_10y_spl2)
melanoma_10y_spl2 <- melanoma_10y_spl2  %>%
group_by(fu) %>%
mutate(interval = group_indices()) ## equivalent to Stata's egen interval=group()
poisson_a <- glm( d ~ as.factor(interval) -1 + offset( log(pt)),
family = poisson,
data = melanoma_10y_spl2 )
summary(poisson_a)
eform(poisson_a)
newdata <- expand.grid(interval = as.factor(1:120), pt = 1 ) ## to have log(pt) = 0
haz_grp <- predict(poisson_a, newdata = newdata, type = "response")
melanoma_10y_spl2$haz_grp <- predict(poisson_a, newdata = newdata, type = "response")
melanoma_10y_spl2$haz_grp <- predict(poisson_a, newdata = melanoma_10y_spl2, type = "response")
View(poisson_a)
View(melanoma_10y_spl2)
melanoma_10y_spl2$haz_grp <- predict(poisson_a, newdata = melanoma_10y_spl2[,pt = 1],
type = "response")
melanoma_10y_spl3 <- melanoma_10y_spl3 %>% mutate ( pt = 1 ) ## to have log(pt) = 0
melanoma_10y_spl3 <- melanoma_10y_spl2 %>% mutate ( pt = 1 ) ## to have log(pt) = 0
View(melanoma_10y_spl3)
melanoma_10y_spl3$haz_grp <- predict(poisson_a, newdata = melanoma_10y_spl3,
type = "response")
View(melanoma_10y_spl3)
melanoma_10y_spl3$haz_grp_1k <- melanoma_10y_spl3$haz_grp*1000
View(melanoma_10y_spl3)
View(melanoma_10y_spl3)
View(melanoma_10y_spl2)
View(melanoma_10y_spl)
ggplot(data = melanoma_10y_spl3, aes(x=fu, y = haz_grp_1k))
?ggplot
??ggplot
library(ggplot)
library(ggplot2)
ggplot(data = melanoma_10y_spl3, aes(x=fu, y = haz_grp_1k))
fu <- levels(melanoma_10y_spl3$fu)
ggplot(data = melanoma_10y_spl3, aes(x=fu, y = haz_grp_1k))
ggplot(data = melanoma_10y_spl3, aes(x=fu, y = haz_grp_1k)) +
geom_point()
ggplot(data = melanoma_10y_spl3, aes(x=fu, y = haz_grp_1k)) +
geom_point()+
xlim(0, 10)+
ylim(0,150)
ggplot(data = melanoma_10y_spl3, aes(x=fu, y = haz_grp_1k)) +
geom_point()+
xlim(0, 10)+
ylim(0, 150)
ggplot(data = melanoma_10y_spl3, aes(x=fu, y = haz_grp_1k)) +
geom_point()+
xlim(0, 10)+
ylim(0, 150)
ggplot(data = melanoma_10y_spl3, aes(x=fu, y = haz_grp_1k)) +
geom_point()+
scale_x_continuous(name="Years from diagnosis", limits = c(0, 10))
fu <- levels(melanoma_10y_spl3$fu)
ggplot(data = melanoma_10y_spl3, aes(x=fu, y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))
yes <- levels(melanoma_10y_spl3$fu)
ggplot(data = melanoma_10y_spl3, aes(x=yes, y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))
ggplot(data = melanoma_10y_spl3, aes(x=fu, y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))
## per 1000 person-years
ggplot(data = melanoma_10y_spl3, aes(x=fu, y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))+
scale_x_discrete(name="Years from diagnosis", limits = c(0, 10))
## per 1000 person-years
ggplot(data = melanoma_10y_spl3, aes(x=fu, y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))+
scale_x_continuous(name="Years from diagnosis", limits = c(0, 10))
ggplot(data = melanoma_10y_spl3, aes(x=as.numeric(fu), y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))+
scale_x_continuous(name="Years from diagnosis", limits = c(0, 10))
## per 1000 person-years
ggplot(data = melanoma_10y_spl3, aes(x=as.numeric(fu), y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))+
scale_x_discrete(name="Years from diagnosis", limits = c(0, 10))
ggplot(data = melanoma_10y_spl3, aes(x=as.numeric(fu), y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))+
scale_x_discrete(name="Years from diagnosis", limits = c(0, 120))
ggplot(data = melanoma_10y_spl3, aes(x=as.numeric(fu), y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))+
scale_x_continuous(name="Years from diagnosis", limits = c(0, 120))
ggplot(data = melanoma_10y_spl3, aes(x=as.numeric(fu), y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))+
scale_x_continuous(name="Years from diagnosis", limits = c(0, 120))
## per 1000 person-years
ggplot(data = melanoma_10y_spl3, aes(x=as.numeric(fu), y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))+
scale_x_continuous(name="Years from diagnosis", limits = c(0, 130))
ggplot(data = melanoma_10y_spl3, aes(x=as.numeric(fu), y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))+
scale_x_continuous(name="Years from diagnosis", limits = c("0", "120"))
## per 1000 person-years
ggplot(data = melanoma_10y_spl3, aes(x=as.numeric(fu), y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))+
scale_x_continuous(name="Years from diagnosis", limits = c(0, 120))
## per 1000 person-years
ggplot(data = melanoma_10y_spl3, aes(x=as.numeric(fu), y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))+
scale_x_continuous(name="Years from diagnosis", limits = c(0, 120/12))
ggplot(data = melanoma_10y_spl3, aes(x=as.numeric(fu), y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))+
scale_x_continuous(name="Years from diagnosis", limits = c(0, 120))
View(melanoma_10y_spl3)
ggplot(data = melanoma_10y_spl3, aes(x=interval, y = haz_grp_1k)) +
ggplot(data = melanoma_10y_spl3, aes(x=interval, y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))+
scale_x_continuous(name="Years from diagnosis", limits = c(0, 120))
ggplot(data = melanoma_10y_spl3, aes(x=interval, y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))+
scale_x_continuous(name="Years from diagnosis", limits = c(0, 120))
ggplot(data = melanoma_10y_spl3, aes(x=interval/12, y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))+
scale_x_continuous(name="Years from diagnosis", limits = c(0, 120))
## per 1000 person-years
ggplot(data = melanoma_10y_spl3, aes(x=interval/12, y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", limits = c(0, 150))+
scale_x_continuous(name="Years from diagnosis", limits = c(0, 10))
ggplot(data = melanoma_10y_spl3, aes(x=interval/12, y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", breaks = c(5 10 20 50 100 150), limits = c(0, 150))+
scale_x_continuous(name="Years from diagnosis", limits = c(0, 10))
ggplot(data = melanoma_10y_spl3, aes(x=interval/12, y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", breaks = c(5,10,20,50,100,150), limits = c(0, 150))+
scale_x_continuous(name="Years from diagnosis", limits = c(0, 10))
## per 1000 person-years
ggplot(data = melanoma_10y_spl3, aes(x=interval/12, y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", breaks = c(5,10,20,50,100,150), limits = c(0, 150))+
scale_x_continuous(name="Years from diagnosis", limits = c(0, 10)) +
ggtitle("Localised skin melanoma. Plot of the estimated baseline hazard function for the piecewise
model.")
source('~/cansurv_r/solutions/q130.R', echo=TRUE)
View(melanoma_10y_spl3)
source('~/cansurv_r/solutions/q130.R', echo=TRUE)
ggplot(data = melanoma_10y_spl3, aes(x=interval/12, y = haz_grp_1k)) +
geom_point()+
scale_y_continuous(name="Baseline hazard (1000 pys)", breaks = c(5,10,20,50,100,150), limits = c(0, 150))+
scale_x_continuous(name="Years from diagnosis", breaks = c(2, 4, 6, 8, 10), limits = c(0, 10)) +
ggtitle("Localised skin melanoma. Plot of the estimated baseline hazard function for the piecewise
model.")
